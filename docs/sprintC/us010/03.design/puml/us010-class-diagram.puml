@startuml
'skinparam monochrome true
skinparam packageStyle rectangle
skinparam shadowing false
skinparam linetype polyline
'skinparam linetype orto

skinparam classAttributeIconSize 0

'left to right directio
class Property{
      - area : double
      - distanceFromCenter : double
      - price : double
      - address : Address
      + getAddress() : Address
      + getArea() : double
      + getDistanceFromCenter() : int
      + getPrice() : double
      + toString() : String
}

class Announcement {
   - typeOfProperty : TypeOfProperty
   - transactionType : TransactionType
   - publishDate : Date
   - comission : Commission
   - photos ArrayList<Photo>
   - isPublished : boolean
   - id : int
   - idCounter : int
   + getProperty() : Property
   + toString() : String
}

class AnnouncementRepository {
    +getAllAnnouncementsSortedByDefualtCriteria() : ArrayList<Announcement>
    +getAllAnnouncementsSortedBySortCriteria(String sortCriteria, String order) : ArrayList<Announcement>
    +getFilteredAnnouncements(TypeOfProperty typeOfProperty, TransactionType transactionType, int numberOfRooms) : ArrayList<Announcement>
    +getFilteredAndSortedAnnouncements(TypeOfProperty typeOfProperty, TransactionType transactionType,\n int numberOfRooms, String sortCriteria, String order) : ArrayList<Announcement>
}

class OrderRepository{
    +clientAlreadyMadeOrderForThisAnnouncement(String clientEmail, int announcementId) : boolean
    +someoneAlreadyMadeOrderWithSameAmountForThisAnnouncement(double orderAmount, int announcementId) : boolean
    +addOrder(double orderAmount, int announcementId, String clientEmail, Date date, OrderState orderState) : void
}

class AuthenticationRepository{
    +getCurrentUserSession() : UserSession
}

class AuthenticationFacade{
    +getCurrentUserSession() : UserSession : UserSession
}

class UserSession{
    +getUserId() : Email
}

class User{
    +getId() : Email
}

class Order{
    -id : int
    -idCounter : int
    -orderAmount : double
    -announcementId : int
    -clientEmail : String
    -date : Date
    -state : OrderState

    +toString() : String
}

class Repositories {
    +Repositories()
    +getInstance() : Repositories
    +getOrderRepository() : OrderRepository
}

class CreateOrderController {
    +someoneAlreadyMadeOrderWithSameAmountForThisAnnouncement(double orderAmount, int announcementId) : boolean
    +clientAlreadyMadeOrderForThisAnnouncement(int announcementId, String userEmail) : boolean
    +getPropertyPriceByAnnouncementId(int id) : double
    +getClientEmail() : String
    +getAllAnnouncements() : ArrayList<Announcement>
    +getPropertyByAnnouncement(Announcement announcement) : Property
    +createOrder(double orderAmount, int announcementId, String clientEmail, Date date, OrderState orderState) : void
}

class CreateOrderUI {
    +showAnnouncements(ArrayList<Announcement> publishedPropertiesList) : void
    +createOrder(amount, id, clientEmail, date, orderState) : void
}


Repositories -> Repositories : instances

CreateOrderUI .> CreateOrderController

CreateOrderController ..> Repositories

Repositories "1" --> "1" AnnouncementRepository : has

Repositories "1" --> "1" AuthenticationRepository : has

Repositories "1" --> "1" OrderRepository : has

CreateOrderController ..> AnnouncementRepository

AnnouncementRepository "1" --> "*" Announcement : has

Announcement "1" --> "1" Property : has

AuthenticationRepository "1" --> "1" AuthenticationFacade : has

AuthenticationFacade "1" --> "1" UserSession : has

UserSession "1" --> "1" User : has

OrderRepository "1" --> "*" Order : has

@enduml